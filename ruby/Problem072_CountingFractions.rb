require 'prime'

def combinations(items)
  return [] unless items.any?
  prefix = items[0]
  suffixes = combinations(items[1..-1])
  [[prefix]] + suffixes + suffixes.map {|item| [prefix] + item }
end

MAX = 1_000_000
ans = 0
x = 0
start = Time.now

(2..MAX).each do |i|
  total = 0
  minus = 0
  map =  i.prime_division.map(&:first)
  com = combinations(map)

  (0...com.length).each do |j|           # [2], [3], [5], [2,3], [3,5], [3,5], [2,3,5]
    if map.length > j 
      total += (i / map[j]) -1
      # puts "(#{i} / #{map[j]}) -1 = #{(i/map[j]) -1}"
    else 
      value = 1
      ((0)...com[j].length).each do |k|
        value *= com[j][k]
      end
      minus = (com[j].length % 2 == 0)? minus + ((i / value) -1) : minus - ((i / value) -1)
      # puts "\t\t (#{i} / (#{value})) -1 = #{(i / value) -1}"
    end
  end

  puts "\t\t\t\t#{i}:  #{total} - #{minus} = #{total-minus}"
  ans += total - minus
  x += (i-1)
end

finish = Time.now
puts "x = #{x}  ans = #{ans}    #{x-ans}     in #{finish - start} seconds"


  # (0...map.length).each do |j|
  #   total += (i / map[j]) -1
  #   # puts "#{i} / #{map[j]} = #{(i/map[j]) -1}"

  #   ((j+1)...map.length).each do |k|
  #     minus += (i / (map[j] * map[k]) -1)
  #     # puts "\t\t (#{i} / (#{map[j]} * #{map[k]})) -1 = #{(i / (map[j] * map[k])) -1}"
  #   end
  # end

#   1/  2x  3/  4x  5/  6x  7x  8x  9/ 10x 11/ 12x 13/ 14x 15/ 16x 17/ 18x 19/ 20x 21x 22x 23/ 24x 25/ 26x 27/ 28x
#        2       2       2       2       2       2       2       2       2       2       2       2       2       2
#                            7                           7                           7                           7 
# 
#
# 28             2 7
# /2 -1 = 13
# /7 -1 = 3
#         ____+
#         16          16 - 1 = 15
#
# 28 / (2*7) -1 = 1
# 
# 
# 
# 30             2 3 5
# /2 -1 = 14
# /3 -1 = 9
# /5 -1 = 5
#         ____+
#         28           28 - 7 = 21
# 
# 30 / (2*3) -1 = 4
# 30 / (2*5) -1 = 2
# 30 / (3*5) -1 = 1
# 
# 
# 
#     1/ 2x  3x  4x  5x  6x  7/  8x  9x 10x 11/ 12x 13/ 14x 15x 16x 17/ 18x 19/ 20x 21x 22x 23/ 24x 25x 26x 27x 28x 29/ 30x 31/ 32x 33x 34x 35x 36x 37/ 38x 39x 40x 41/ 42x 43/ 44x 45x 46x 47/ 48x 49/ 50x 51x 52x 53/ 54x 55x 56x 57x 58x 59/ 60x         
#         2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2       2
#             3           _           3           _           3           _           3           _           3           _           3           _           3           _           3           _           3           _           3           3
#                     5                   _                   _                   _                   5                   __                   5                   _                   _                   _                   5                   5
#
# 
# 60
# /2 -1 = 29
# /3 -1 = 19
# /5 -1 = 11
#         ____+
#         59           59 - 18 = 41
# 
# 60 / (2*3) -1 = _
# 60 / (2*5) -1 = _
# 60 / (3*5) -1 = 3
# 60 / (2*3*5) -1 = 1   <---- TODO
# 
# 
# 
#                                                                                                        
#                                                                                                 1/2     1
#                                                                                           1/3   2/3     3
#                                                                                     1/4   2x4   3/4     5
#                                                                               1/5   2/5   3/5   4/5     9
#                                                                         1/6   2x6   3x6   4x6   5/6     11
#                                                                   1/7   2/7   3/7   4/7   5/7   6/7     17
#                                                             1/8   2x8   3/8   4x8   5/8   6x8   7/8     21
#                                                        1/9  2/9   3x9   4/9   5/9   6x9   7/9   8/9   	27
#                                                 1/10  2x10  3/10  4x10  5x10  6x10  7/10  8x10  9/10  	31
#                                           1/11  2/11  3/11  4/11  5/11  6/11  7/11  8/11  9/11 10/11    41
#                                     1/12  2x12  3x12  4x12  5/12  6x12  7/12  8x12  9x12 10x12 11/12    45
#                               1/13  2/13  3/13  4/13  5/13  6/13  7/13  8/13  9/13 10/13 11/13 12/13    57
#                         1/14  2x14  3/14  4x14  5/14  6x14  7x14  8x14  9/14 10x14 11/14 12x14 13/14    63
#                   1/15  2/15  3x15  4/15  5x15  6/15  7/15  8/15  9x15 10x15 11/15 12x15 13/15 14/15    71
#             1/16  2x16  3/16  4x16  5/16  6x16  7/16  8x16  9/16 10x16 11/16 12x16 13/16 14x16 15/16    79
#       1/17  2/17  3/17  4/17  5/17  6/17  7/17  8/17  9/17 10/17 11/17 12/17 13/17 14/17 15/17 16/17    95
# 1/18  2x18  3x18  4x18  5/18  6x18  7/18  8x18  9x18 10x18 11/18 12x18 13/18 14x18 15/18 16x18 17/18    101
#
#
# 1/2   1/3   1/4   1/5   1/6   1/7   1/8   1/9   1/10  1/11  1/12  1/13  1/14  1/15  1/16  1/17  1/18  1/19  1/20  1/21  1/22  1/23  1/24  1/25  1/26  1/27  1/28  1/29  1/30
#       2/3   2x4   2/5   2x6   2/7   2x8   2/9   2x10  2/11  2x12  2/13  2x14  2/15  2x16  2/17  2x18  2/19  2x20  2/21  2x22  2/23  2x24  2/25  2/26  2/27  2/28  2/29  2/30
#             3/4   3/5   3x6   3/7   3/8   3x9   3/10  3/11  3x12  3/13  3/14  3x15  3/16  3/17  3x18  3/19  3/20  3/21  3/22  3/23  3x24  3/25  3/26  3/27  3/28  3/29  3/30
#                   4/5   4x6   4/7   4x8   4/9   4x10  4/11  4x12  4/13  4x14  4/15  4x16  4/17  4x18  4/19  4x20  4/21  4x22  4/23  4x24  4/25  4/26  4/27  4/28  4/29  4/30
#                         5/6   5/7   5/8   5/9   5x10  5/11  5/12  5/13  5/14  5x15  5/16  5/17  5/18  5/19  5x20  5/21  5/22  5/23  5/24  5x25  5/26  5/27  5/28  5/29  5/30
#                               6/7   6x8   6x9   6x10  6/11  6x12  6/13  6x14  6x15  6x16  6/17  6x18  6/19  6x20  6/21  6x22  6/23  6x24  6/25  6/26  6/27  6/28  6/29  6/30
#                                     7/8   7/9   7/10  7/11  7/12  7/13  7x14  7/15  7/16  7/17  7/18  7/19  7/20  7/21  7/22  7/23  7/24  7/25  7/26  7/27  7/28  7/29  7/30
#                                           8/9   8x10  8/11  8x12  8/13  8x14  8/15  8x16  8/17  8x18  8/19  8x20  8/21  8x22  8/23  8x24  8/25  8/26  8/27  8/28  8/29  8/30
#                                                 9/10  9/11  9x12  9/13  9/14  9x15  9/16  9/17  9x18  9/19  9/20  9/21  9/22  9/23  9x24  9/25  9/26  9/27  9/28  9/29  9/30
#                                                      10/11 10x12 10/13 10x14 10x15 10x16 10/17 10x18 10/19 10x20 10/21 10x22 10/23 10x24 10x25 10/26 10/27 10/28 10/29 10/30
#                                                            11/12 11/13 11/14 11/15 11/16 11/17 11/18 11/19 11/20 11/21 11x22 11/23 11/24 11/25 11/26 11/27 11/28 11/29 11/30
#                                                                  12/13 12x14 12x15 12x16 12/17 12x18 12/19 12x20 12/21 12x22 12/23 12x24 12/25 12/26 12/27 12/28 12/29 12/30
#                                                                        13/14 13/15 13/16 13/17 13/18 13/19 13/20 13/21 13/22 13/23 13/24 13/25 13/26 13/27 13/28 13/29 13/30
#                                                                              14/15 14x16 14/17 14x18 14/19 14x20 14/21 14x22 14/23 14x24 14/25 14/26 14/27 14/28 14/29 14/30
#                                                                                    15/16 15/17 15x18 15/19 15x20 15/21 15/22 15/23 15x24 15x25 15/26 15/27 15/28 15/29 15/30
#                                                                                          16/17 16x18 16/19 16x20 16/21 16x22 16/23 16x24 16/25 16/26 16/27 16/28 16/29 16/30
#                                                                                                17/18 17/19 17/20 17/21 17/22 17/23 17/24 17/25 17/26 17/27 17/28 17/29 17/30
#                                                                                                      18/19 18x20 18/21 18x22 18/23 18x24 18/25 18/26 18/27 18/28 18/29 18/30
#                                                                                                            19/20 19/21 19/22 19/23 19/24 19/25 19/26 19/27 19/28 19/29 19/30
#                                                                                                                  20/21 20x22 20/23 20x24 20x25 20/26 20/27 20/28 20/29 20/30
#                                                                                                                        21/22 21/23 21x24 21/25 21/26 21/27 21/28 21/29 21/30
#                                                                                                                              22/23 22x24 22/25 22/26 22/27 22/28 22/29 22/30
#                                                                                                                                    23/24 23/25 23/26 23/27 23/28 23/29 23/30
#                                                                                                                                          24/25 24/26 24/27 24/28 24/29 24/30
#                                                                                                                                                25/26 25/27 25/28 25/29 25/30
#                                                                                                                                                      26/27 26/28 26/29 26/30
#                                                                                                                                                            27/28 27/29 27/30
#                                                                                                                                                                  28/29 28/30
#                                                                                                                                                                        29/30
#
#
# 1/2 --1/3  1/4--1/5  1/6--1/7  1/8--1/9  
#        |  /     /    /    /    /    /  
#       2/3    2/4  2/5  2/6  2/7   __  
#               |  /    /    /    /
#              3/4   3/5  3/6   __
#                     |  /    /     
#                    4/5   4/6  __     
#                           | /    
#                          5/6   
#
# 1/2   |   1/3 2/3 1/4   |   1/5 2/4 3/4 2/5 1/6    |   1/7 2/6 3/5 4/5 3/6 2/7 1/8   |   1/9 2/8 3/7 4/6 5/6 4/7 3/8 2/9 1/10   |


# MAX = 210




# def ex(i, j)
#   map = i.prime_division.map(&:first)
#   (0...map.length).each do |n|
#     if (j % map[n] == 0)
#       return "x"
#     end
#   end

#   return "/"
# end

# text = ""
# (1..MAX).each do |i|
#   (2..i).each do |n|
#     text << "          "
#   end
#   ((i+1)..MAX).each do |j| 
#     t = "#{i}#{ex(i,j)}#{j}"
#     while t.length < 10
#       t = " "+t
#     end
#     text << t
#   end
#   text << "\n"
# end

# File.open("tmp.rb", 'w') { |file| file.write(text) }
# puts text










# Consider the fraction, n/d, where n and d are positive integers. If n < d
# and HCF(n,d)=1, it is called a reduced proper fraction.

# If we list the set of reduced proper fractions for d 8 in ascending order
# of size, we get:

# 1/8, 1/7, 1/6, 1/5, 1/4, 2/7, 1/3, 3/8, 2/5, 3/7, 1/2, 4/7, 3/5, 5/8, 2/3,
#                        5/7, 3/4, 4/5, 5/6, 6/7, 7/8

# It can be seen that there are 21 elements in this set.

# How many elements would be contained in the set of reduced proper
# fractions for d 1,000,000?